<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Eric Hausken, Alicia Talavera, Giorgio Rivoli">

<title>Survey Methodology II - Final Project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="project_files/libs/clipboard/clipboard.min.js"></script>
<script src="project_files/libs/quarto-html/quarto.js"></script>
<script src="project_files/libs/quarto-html/popper.min.js"></script>
<script src="project_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="project_files/libs/quarto-html/anchor.min.js"></script>
<link href="project_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="project_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="project_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="project_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="project_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Survey Methodology II - Final Project</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Eric Hausken, Alicia Talavera, Giorgio Rivoli </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<p>From 2012 to 2019, surveys were conducted at the European Union level focusing on aspects such as discrimination existing in the EU. In 2019, one of the questions was: <em>“Do you think that transgender people should be able to change their civil documents to match their inner gender identity?”</em> The objective of this work is to detect which variables influence whether an individual responds positively or negatively to this question.</p>
<section id="packages-used" class="level2">
<h2 class="anchored" data-anchor-id="packages-used">Packages used</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
✔ ggplot2 3.4.4     ✔ purrr   1.0.2
✔ tibble  3.2.1     ✔ dplyr   1.1.4
✔ tidyr   1.3.1     ✔ stringr 1.5.1
✔ readr   2.1.5     ✔ forcats 1.0.0</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tidyr' was built under R version 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'readr' was built under R version 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'dplyr' was built under R version 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'stringr' was built under R version 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'mice'

The following object is masked from 'package:stats':

    filter

The following objects are masked from 'package:base':

    cbind, rbind</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'gridExtra'

The following object is masked from 'package:dplyr':

    combine</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lattice

Attaching package: 'caret'

The following object is masked from 'package:purrr':

    lift</code></pre>
</div>
</div>
</section>
<section id="loading-databases" class="level1">
<h1>Loading databases</h1>
<p>Our main database is the EU survey conducted in 2019. Then, we added some variables on country level. First, a GINI index database, which shows the value of the index for each country. Second, more specifically about LGBT+ rights in the EU countries, a database which includes data regarding whether a country has legal homosexual marriage, procedures for trans people name or legal sex change, hate crime laws, etc. This database is from ILGA-Europe and the Rainbow Europe Map and Index 2019.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Main database</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># data &lt;- read_dta("ZA7575.dta")</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="st">"Data/ZA7575.dta"</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co"># GINI index database</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>gini <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"eu_gini_coef.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 350 Columns: 8
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (6): DATAFLOW, LAST UPDATE, freq, indic_il, geo, OBS_FLAG
dbl (2): TIME_PERIOD, OBS_VALUE

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># LGBTphobia database</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>ilga <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"ilga.xlsx"</span>, <span class="at">sheet =</span> <span class="dv">2</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>ilga <span class="ot">&lt;-</span> ilga <span class="sc">|&gt;</span> </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CONTINENT <span class="sc">==</span> <span class="st">"EUROPE"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="merging-together-countries-database" class="level3">
<h3 class="anchored" data-anchor-id="merging-together-countries-database">Merging together Countries database</h3>
<p>Now, we merge both GINI and ILGA databases together to create a ‘countries’ database.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>names <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">COUNTRY =</span> <span class="fu">c</span>(</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Belgium"</span>, <span class="st">"Greece"</span>, <span class="st">"Lithuania"</span>, <span class="st">"Portugal"</span>, <span class="st">"Bulgaria"</span>, <span class="st">"Spain"</span>, <span class="st">"Luxembourg"</span>, <span class="st">"Romania"</span>, <span class="st">"Czechia"</span>, <span class="st">"France"</span>, </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Hungary"</span>, <span class="st">"Slovenia"</span>, <span class="st">"Denmark"</span>, <span class="st">"Croatia"</span>, <span class="st">"Malta"</span>, <span class="st">"Slovakia"</span>, <span class="st">"Germany"</span>, <span class="st">"Italy"</span>, <span class="st">"Netherlands"</span>, <span class="st">"Finland"</span>, <span class="st">"Estonia"</span>, <span class="st">"Cyprus"</span>, <span class="st">"Austria"</span>, <span class="st">"Sweden"</span>, <span class="st">"Ireland"</span>, <span class="st">"Latvia"</span>, <span class="st">"Poland"</span>,  <span class="st">"Iceland"</span>, <span class="st">"Norway"</span>, <span class="st">"Liechtenstein"</span>, <span class="st">"Switzerland"</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Bosnia and Herzegovina"</span>, <span class="st">"Montenegro"</span>, <span class="st">"Moldova"</span>, <span class="st">"North Macedonia"</span>, <span class="st">"Georgia"</span>, <span class="st">"Albania"</span>, <span class="st">"Serbia"</span>, <span class="st">"Türkiye"</span>, </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ukraine"</span>,<span class="st">"Kosovo"</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">geo =</span> <span class="fu">c</span>(</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"BE"</span>, <span class="st">"EL"</span>, <span class="st">"LT"</span>, <span class="st">"PT"</span>, <span class="st">"BG"</span>, <span class="st">"ES"</span>, <span class="st">"LU"</span>, <span class="st">"RO"</span>, <span class="st">"CZ"</span>, <span class="st">"FR"</span>, <span class="st">"HU"</span>, <span class="st">"SI"</span>, <span class="st">"DK"</span>, <span class="st">"HR"</span>, <span class="st">"MT"</span>, <span class="st">"SK"</span>, <span class="st">"DE"</span>, <span class="st">"IT"</span>, <span class="st">"NL"</span>, <span class="st">"FI"</span>, <span class="st">"EE"</span>, <span class="st">"CY"</span>, <span class="st">"AT"</span>, <span class="st">"SE"</span>, <span class="st">"IE"</span>, <span class="st">"LV"</span>, <span class="st">"PL"</span>, <span class="st">"IS"</span>, <span class="st">"NO"</span>, <span class="st">"LI"</span>, <span class="st">"CH"</span>, <span class="st">"BA"</span>, <span class="st">"ME"</span>, <span class="st">"MD"</span>, <span class="st">"MK"</span>, <span class="st">"GE"</span>, <span class="st">"AL"</span>, <span class="st">"RS"</span>, <span class="st">"TR"</span>, <span class="st">"UA"</span>,<span class="st">"XK"</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>gini <span class="ot">&lt;-</span> gini <span class="sc">|&gt;</span> </span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(geo, TIME_PERIOD, OBS_VALUE, OBS_FLAG) <span class="sc">|&gt;</span> </span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(TIME_PERIOD <span class="sc">==</span> <span class="st">"2019"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(names, <span class="at">by =</span> <span class="st">"geo"</span>)</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>countries <span class="ot">&lt;-</span> gini <span class="sc">|&gt;</span> </span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(ilga, <span class="at">by =</span> <span class="st">"COUNTRY"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>TIME_PERIOD, CONTINENT) <span class="sc">|&gt;</span> </span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(CONTINENT))</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Turn all ILGA variables to factors</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>countries <span class="ot">&lt;-</span> countries <span class="sc">|&gt;</span> </span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="dv">7</span><span class="sc">:</span><span class="fu">ncol</span>(countries)), as.factor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="selecting-variables-in-the-main-dataset" class="level2">
<h2 class="anchored" data-anchor-id="selecting-variables-in-the-main-dataset">Selecting variables in the main dataset</h2>
<p>There are over 600 columns in the original database, so we selected only a few that were relevant to the topic, as well as sociodemographic variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>selected_data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    uniqid, </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    isocntry, <span class="co"># nationality keep </span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    d11, <span class="co"># age  </span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    d70, <span class="co"># life satisfaction -recode below DK == NA</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    polintr, <span class="co"># political interest -recode below DK == NA</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    qa1, <span class="co"># globalization scale 1-4, convert 5 to NA </span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># qa5a,</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># qa7,</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># qa8,</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># qa9,</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># qa11,</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># qa12,</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># qa13,</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># qa14,</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># qa17,</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    sd1_7, <span class="co"># do you know someone who is transgender. </span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># sd2_1, sd2_2, sd2_3, sd2_4, sd2_5, sd2_6, sd2_7, sd2_8,</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>    sd3, </span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>    qc1_4, </span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    qc1_8,</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>    qc2_1<span class="sc">:</span>qc2_14, <span class="co"># recode to 1 for discrimination == yes</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>      qc2_15, <span class="co"># recode to 0. discriminatino == no</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>      qc2_16, <span class="co"># recode to NA, impute missing data.  DONT KNOW</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># qc3,</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># qc4,</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>    qc5_1, qc5_3,</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>    qc6_1r, qc6_2r, qc6_3r, qc6_10r, <span class="co"># is there discrimination towards...</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>    qc7,</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>    qc9_1,qc9_4, qc9_5, qc9_10,</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>    qc12_1r, qc12_2r, qc12_6r, qc12_10r, qc12_11r,</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>   <span class="co"># qc13_1r, qc13_2r, qc13_3r, qc13_4r, qc13_5r, qc13_6r, qc13_7r, qc13_8r, qc13_9r, qc13_10r, qc13_11r, qc13_12r, qc13_13r, qc13_14r, qc13_15r,</span></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>    qc15_1<span class="sc">:</span>qc15_3,</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>    qc17_1<span class="sc">:</span>qc17_5,</span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>    qc18_1r, qc18_2r, qc18_3r,</span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>    qc19, <span class="co"># TARGET VARIABLE </span></span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>    qc20,</span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>    d1, <span class="co"># keep, scale from 0-10, remove 11, 12</span></span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># d7,</span></span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>    d10, <span class="co"># gender keep </span></span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>    d8, <span class="co"># keep education years </span></span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>    d15a, <span class="co"># convert to factor. occupation </span></span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>    d25, <span class="co"># keep type of city </span></span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># d40a, d40b, d40c, d43a, d43b,</span></span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>    d60, <span class="co"># financial keep </span></span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>    d62_1,  <span class="co"># keep internet at home. calculate average </span></span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>    d63, <span class="co"># class keep. as factor </span></span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>    d72_1, d72_2, <span class="co"># keep. does my voice count</span></span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a>    p3r, <span class="co"># paradata</span></span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>    p5, <span class="co"># paradata</span></span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a>    p4 <span class="co"># paradata</span></span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a>selected_data <span class="ot">&lt;-</span> selected_data <span class="sc">|&gt;</span> </span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">geo =</span> isocntry) <span class="sc">|&gt;</span> </span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(names, <span class="at">by =</span> <span class="st">"geo"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="cleaning-missing-data" class="level2">
<h2 class="anchored" data-anchor-id="cleaning-missing-data">Cleaning missing data</h2>
<p>Regarding missing data, we drop out some variables for having too many NAs and impute the rest of varibles we will use. We decide not to impute the target variable to check how NAs distribution change.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>imputed_data <span class="ot">&lt;-</span> selected_data <span class="sc">|&gt;</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">d70 =</span> <span class="fu">ifelse</span>(d70 <span class="sc">==</span> <span class="dv">5</span>, <span class="cn">NA</span>, <span class="fu">as.numeric</span>(d70))) <span class="sc">|&gt;</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">qa1 =</span> <span class="fu">ifelse</span>(qa1 <span class="sc">&gt;</span> <span class="dv">5</span>, <span class="cn">NA</span>, <span class="fu">as.numeric</span>(qa1))) <span class="sc">|&gt;</span> </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">polintr =</span> <span class="fu">ifelse</span>(polintr <span class="sc">==</span> <span class="dv">4</span>, <span class="cn">NA</span>, <span class="fu">as.numeric</span>(polintr))) <span class="sc">|&gt;</span> </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">d63 =</span> <span class="fu">ifelse</span>(d63 <span class="sc">&gt;</span> <span class="dv">5</span>, <span class="cn">NA</span>, <span class="fu">as.numeric</span>(d63))) <span class="sc">|&gt;</span> </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">d72_1 =</span> <span class="fu">ifelse</span>(d72_1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">6</span>), <span class="cn">NA</span>, <span class="fu">as.numeric</span>(d72_1))) <span class="sc">|&gt;</span> </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">d72_2 =</span> <span class="fu">ifelse</span>(d72_2 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">6</span>), <span class="cn">NA</span>, <span class="fu">as.numeric</span>(d72_2))) <span class="sc">|&gt;</span> </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sd3 =</span> <span class="fu">ifelse</span>(sd3 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">14</span>,<span class="dv">15</span>,<span class="dv">16</span>), <span class="cn">NA</span>, <span class="fu">as.numeric</span>(sd3))) <span class="sc">|&gt;</span> </span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">qa1 =</span> <span class="fu">ifelse</span>(qa1 <span class="sc">%in%</span> <span class="dv">5</span>, <span class="cn">NA</span>, <span class="fu">as.numeric</span>(qa1))) <span class="sc">|&gt;</span> </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sd1_7 =</span> <span class="fu">ifelse</span>(sd1_7 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>), <span class="cn">NA</span>, <span class="fu">as.numeric</span>(sd1_7))) <span class="sc">|&gt;</span> </span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">d25 =</span> <span class="fu">ifelse</span>(d25 <span class="sc">&gt;</span> <span class="dv">3</span>, <span class="cn">NA</span>, <span class="fu">as.numeric</span>(d25))) <span class="sc">|&gt;</span> </span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">d8 =</span> <span class="fu">ifelse</span>(d8 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">98</span>,<span class="dv">99</span>, <span class="dv">97</span>), <span class="cn">NA</span>, <span class="fu">as.numeric</span>(d8))) <span class="sc">|&gt;</span> </span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">qc1_4 =</span> <span class="fu">ifelse</span>(qc1_4 <span class="sc">&gt;</span> <span class="dv">4</span>, <span class="cn">NA</span>, <span class="fu">as.numeric</span>(qc1_4))) <span class="sc">|&gt;</span> </span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">qc1_8 =</span> <span class="fu">ifelse</span>(qc1_8 <span class="sc">&gt;</span> <span class="dv">4</span>, <span class="cn">NA</span>, <span class="fu">as.numeric</span>(qc1_8))) <span class="sc">|&gt;</span> </span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">qc6_1r =</span> <span class="fu">ifelse</span>(qc6_1r<span class="sc">&gt;</span> <span class="dv">3</span>, <span class="cn">NA</span>, <span class="fu">as.numeric</span>(qc6_1r))) <span class="sc">|&gt;</span> </span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">qc6_2r =</span> <span class="fu">ifelse</span>(qc6_2r <span class="sc">&gt;</span> <span class="dv">3</span>, <span class="cn">NA</span>, <span class="fu">as.numeric</span>(qc6_2r))) <span class="sc">|&gt;</span>    <span class="fu">mutate</span>(<span class="at">qc6_3r =</span> <span class="fu">ifelse</span>(qc6_3r<span class="sc">&gt;</span><span class="dv">3</span>, <span class="cn">NA</span>, <span class="fu">as.numeric</span>(qc6_3r))) <span class="sc">|&gt;</span> </span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">qc6_10r =</span> <span class="fu">ifelse</span>(qc6_10r<span class="sc">&gt;</span><span class="dv">3</span>,<span class="cn">NA</span>,<span class="fu">as.numeric</span>(qc6_10r))) <span class="sc">|&gt;</span> </span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">qc7 =</span> <span class="fu">ifelse</span>(qc7<span class="sc">&gt;</span><span class="dv">10</span>,<span class="cn">NA</span>,<span class="fu">as.numeric</span>(qc7))) <span class="sc">|&gt;</span> </span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">qc9_1 =</span> <span class="fu">ifelse</span>(qc9_1<span class="sc">&gt;</span><span class="dv">4</span>,<span class="cn">NA</span>,<span class="fu">as.numeric</span>(qc9_1))) <span class="sc">|&gt;</span> </span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">qc9_4 =</span> <span class="fu">ifelse</span>(qc9_4<span class="sc">&gt;</span><span class="dv">4</span>,<span class="cn">NA</span>,<span class="fu">as.numeric</span>(qc9_4))) <span class="sc">|&gt;</span> </span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">qc9_5 =</span> <span class="fu">ifelse</span>(qc9_5<span class="sc">&gt;</span><span class="dv">4</span>,<span class="cn">NA</span>,<span class="fu">as.numeric</span>(qc9_5))) <span class="sc">|&gt;</span> </span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">qc9_10 =</span> <span class="fu">ifelse</span>(qc9_10<span class="sc">&gt;</span><span class="dv">4</span>,<span class="cn">NA</span>,<span class="fu">as.numeric</span>(qc9_10))) <span class="sc">|&gt;</span> </span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">qc5_1 =</span> <span class="fu">ifelse</span>(qc5_1<span class="sc">&gt;</span><span class="dv">2</span>,<span class="cn">NA</span>,<span class="fu">as.numeric</span>(qc5_1))) <span class="sc">|&gt;</span> </span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">qc5_3 =</span> <span class="fu">ifelse</span>(qc5_3<span class="sc">&gt;</span><span class="dv">2</span>,<span class="cn">NA</span>,<span class="fu">as.numeric</span>(qc5_3))) <span class="sc">|&gt;</span> </span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">qc12_1r =</span> <span class="fu">ifelse</span>(qc12_1r<span class="sc">&gt;</span><span class="dv">10</span>,<span class="cn">NA</span>,<span class="fu">as.numeric</span>(qc12_1r))) <span class="sc">|&gt;</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">qc12_2r =</span> <span class="fu">ifelse</span>(qc12_2r<span class="sc">&gt;</span><span class="dv">10</span>,<span class="cn">NA</span>,<span class="fu">as.numeric</span>(qc12_2r))) <span class="sc">|&gt;</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">qc12_6r =</span> <span class="fu">ifelse</span>(qc12_6r<span class="sc">&gt;</span><span class="dv">10</span>,<span class="cn">NA</span>,<span class="fu">as.numeric</span>(qc12_6r))) <span class="sc">|&gt;</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">qc12_10r =</span> <span class="fu">ifelse</span>(qc12_10r<span class="sc">&gt;</span><span class="dv">10</span>,<span class="cn">NA</span>,<span class="fu">as.numeric</span>(qc12_10r))) <span class="sc">|&gt;</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">qc12_11r =</span> <span class="fu">ifelse</span>(qc12_11r<span class="sc">&gt;</span><span class="dv">10</span>,<span class="cn">NA</span>,<span class="fu">as.numeric</span>(qc12_11r))) <span class="sc">|&gt;</span> </span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">qc15_1 =</span> <span class="fu">ifelse</span>(qc15_1<span class="sc">&gt;</span><span class="dv">4</span>,<span class="cn">NA</span>,<span class="fu">as.numeric</span>(qc15_1))) <span class="sc">|&gt;</span> </span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">qc15_2 =</span> <span class="fu">ifelse</span>(qc15_2<span class="sc">&gt;</span><span class="dv">4</span>,<span class="cn">NA</span>,<span class="fu">as.numeric</span>(qc15_2))) <span class="sc">|&gt;</span> </span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">qc15_3 =</span> <span class="fu">ifelse</span>(qc15_3<span class="sc">&gt;</span><span class="dv">4</span>,<span class="cn">NA</span>,<span class="fu">as.numeric</span>(qc15_3))) <span class="sc">|&gt;</span> </span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">qc17_1 =</span> <span class="fu">ifelse</span>(qc17_1<span class="sc">&gt;</span><span class="dv">4</span>,<span class="cn">NA</span>,<span class="fu">as.numeric</span>(qc17_1))) <span class="sc">|&gt;</span> </span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">qc17_2 =</span> <span class="fu">ifelse</span>(qc17_2<span class="sc">&gt;</span><span class="dv">4</span>,<span class="cn">NA</span>,<span class="fu">as.numeric</span>(qc17_2))) <span class="sc">|&gt;</span> </span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">qc17_3 =</span> <span class="fu">ifelse</span>(qc17_3<span class="sc">&gt;</span><span class="dv">4</span>,<span class="cn">NA</span>,<span class="fu">as.numeric</span>(qc17_3))) <span class="sc">|&gt;</span> </span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">qc17_4 =</span> <span class="fu">ifelse</span>(qc17_4<span class="sc">&gt;</span><span class="dv">4</span>,<span class="cn">NA</span>,<span class="fu">as.numeric</span>(qc17_4))) <span class="sc">|&gt;</span> </span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">qc17_5 =</span> <span class="fu">ifelse</span>(qc17_5<span class="sc">&gt;</span><span class="dv">4</span>,<span class="cn">NA</span>,<span class="fu">as.numeric</span>(qc17_5))) <span class="sc">|&gt;</span> </span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">qc18_1r =</span> <span class="fu">ifelse</span>(qc18_1r<span class="sc">&gt;</span><span class="dv">3</span>,<span class="cn">NA</span>,<span class="fu">as.numeric</span>(qc18_1r))) <span class="sc">|&gt;</span> </span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">qc18_2r =</span> <span class="fu">ifelse</span>(qc18_2r<span class="sc">&gt;</span><span class="dv">3</span>,<span class="cn">NA</span>,<span class="fu">as.numeric</span>(qc18_2r))) <span class="sc">|&gt;</span> </span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">qc18_3r =</span> <span class="fu">ifelse</span>(qc18_3r<span class="sc">&gt;</span><span class="dv">3</span>,<span class="cn">NA</span>,<span class="fu">as.numeric</span>(qc18_3r))) <span class="sc">|&gt;</span> </span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">qc20 =</span> <span class="fu">ifelse</span>(qc20<span class="sc">&gt;</span><span class="dv">2</span>,<span class="cn">NA</span>,<span class="fu">as.numeric</span>(qc20))) <span class="sc">|&gt;</span> </span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">d1 =</span> <span class="fu">ifelse</span>(d1<span class="sc">&gt;</span><span class="dv">10</span>,<span class="cn">NA</span>,<span class="fu">as.numeric</span>(d1)))</span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>imputed_data <span class="ot">&lt;-</span> imputed_data <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="st">"d70"</span>, <span class="st">"qa1"</span>, <span class="st">"polintr"</span>, <span class="st">"d63"</span>, <span class="st">"d72_1"</span>, <span class="st">"d72_2"</span>, <span class="st">"sd3"</span>, <span class="st">"sd1_7"</span>, <span class="st">"d25"</span>, <span class="st">"d8"</span>, <span class="st">"qc1_4"</span>, <span class="st">"qc1_8"</span>, <span class="st">"qc6_1r"</span>, <span class="st">"qc6_2r"</span>,<span class="st">"qc6_3r"</span>, <span class="st">"qc6_10r"</span>, <span class="st">"qc7"</span>, <span class="st">"qc9_1"</span>, <span class="st">"qc9_4"</span>, <span class="st">"qc9_5"</span>,<span class="st">"qc9_10"</span>, <span class="st">"qc5_1"</span>, <span class="st">"qc5_3"</span>, <span class="st">"qc12_1r"</span>, <span class="st">"qc12_2r"</span>, <span class="st">"qc12_6r"</span>, <span class="st">"qc12_10r"</span>, <span class="st">"qc12_11r"</span>, <span class="st">"qc15_1"</span>, <span class="st">"qc15_2"</span>, <span class="st">"qc15_3"</span>, <span class="st">"qc17_1"</span>, <span class="st">"qc17_2"</span>, <span class="st">"qc17_3"</span>, <span class="st">"qc17_3"</span>, <span class="st">"qc17_5"</span>, <span class="st">"qc18_1r"</span>, <span class="st">"qc18_2r"</span>, <span class="st">"qc18_3r"</span>, <span class="st">"qc20"</span>, <span class="st">"d1"</span>)</span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>meth <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"rf"</span>, <span class="dv">40</span>)</span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a>meth[<span class="fu">c</span>(<span class="st">"d70"</span>, <span class="st">"qa1"</span>, <span class="st">"polintr"</span>, <span class="st">"d63"</span>, <span class="st">"d72_1"</span>, <span class="st">"d72_2"</span>, <span class="st">"sd3"</span>, <span class="st">"sd1_7"</span>, <span class="st">"d25"</span>, <span class="st">"d8"</span>, <span class="st">"qc1_4"</span>, <span class="st">"qc1_8"</span>, <span class="st">"qc6_1r"</span>, <span class="st">"qc6_2r"</span>,<span class="st">"qc6_3r"</span>, <span class="st">"qc6_10r"</span>, <span class="st">"qc7"</span>, <span class="st">"qc9_1"</span>, <span class="st">"qc9_4"</span>, <span class="st">"qc9_5"</span>,<span class="st">"qc9_10"</span>, <span class="st">"qc5_1"</span>, <span class="st">"qc5_3"</span>, <span class="st">"qc12_1r"</span>, <span class="st">"qc12_2r"</span>, <span class="st">"qc12_6r"</span>, <span class="st">"qc12_10r"</span>, <span class="st">"qc12_11r"</span>, <span class="st">"qc15_1"</span>, <span class="st">"qc15_2"</span>, <span class="st">"qc15_3"</span>, <span class="st">"qc17_1"</span>, <span class="st">"qc17_2"</span>, <span class="st">"qc17_3"</span>, <span class="st">"qc17_3"</span>, <span class="st">"qc17_5"</span>, <span class="st">"qc18_1r"</span>, <span class="st">"qc18_2r"</span>, <span class="st">"qc18_3r"</span>, <span class="st">"qc20"</span>, <span class="st">"d1"</span>)] <span class="ot">&lt;-</span> <span class="st">"rf"</span></span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a>init <span class="ot">=</span> <span class="fu">mice</span>(imputed_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 iter imp variable
  1   1  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  1   2  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  1   3  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  1   4  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  1   5  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  2   1  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  2   2  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  2   3  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  2   4  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  2   5  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  3   1  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  3   2  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  3   3  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  3   4  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  3   5  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  4   1  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  4   2  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  4   3  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  4   4  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  4   5  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  5   1  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  5   2  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  5   3  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  5   4  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  5   5  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>meth <span class="ot">=</span> init<span class="sc">$</span>method</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>meth[<span class="fu">c</span>(<span class="st">"d70"</span>, <span class="st">"qa1"</span>, <span class="st">"polintr"</span>, <span class="st">"d63"</span>, <span class="st">"d72_1"</span>, <span class="st">"d72_2"</span>, <span class="st">"sd3"</span>, <span class="st">"sd1_7"</span>, <span class="st">"d25"</span>, <span class="st">"d8"</span>, <span class="st">"qc1_4"</span>, <span class="st">"qc1_8"</span>, <span class="st">"qc6_1r"</span>, <span class="st">"qc6_2r"</span>,<span class="st">"qc6_3r"</span>, <span class="st">"qc6_10r"</span>, <span class="st">"qc7"</span>, <span class="st">"qc9_1"</span>, <span class="st">"qc9_4"</span>, <span class="st">"qc9_5"</span>,<span class="st">"qc9_10"</span>, <span class="st">"qc5_1"</span>, <span class="st">"qc5_3"</span>, <span class="st">"qc12_1r"</span>, <span class="st">"qc12_2r"</span>, <span class="st">"qc12_6r"</span>, <span class="st">"qc12_10r"</span>, <span class="st">"qc12_11r"</span>, <span class="st">"qc15_1"</span>, <span class="st">"qc15_2"</span>, <span class="st">"qc15_3"</span>, <span class="st">"qc17_1"</span>, <span class="st">"qc17_2"</span>, <span class="st">"qc17_3"</span>, <span class="st">"qc17_3"</span>, <span class="st">"qc17_5"</span>, <span class="st">"qc18_1r"</span>, <span class="st">"qc18_2r"</span>, <span class="st">"qc18_3r"</span>, <span class="st">"qc20"</span>, <span class="st">"d1"</span>)] <span class="ot">&lt;-</span> <span class="st">"rf"</span> </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>imputed_rf <span class="ot">=</span> <span class="fu">mice</span>(imputed_data, <span class="at">methid=</span>meth, <span class="at">iterations =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 iter imp variable
  1   1  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  1   2  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  1   3  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  1   4  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  1   5  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  2   1  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  2   2  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  2   3  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  2   4  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  2   5  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  3   1  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  3   2  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  3   3  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  3   4  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  3   5  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  4   1  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  4   2  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  4   3  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  4   4  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  4   5  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  5   1  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  5   2  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  5   3  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  5   4  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1
  5   5  d70  qa1  polintr  d63  d72_1  d72_2  sd3  sd1_7  d25  d8  qc1_4  qc1_8  qc6_1r  qc6_2r  qc6_3r  qc6_10r  qc7  qc9_1  qc9_4  qc9_5  qc9_10  qc5_1  qc5_3  qc15_1  qc15_2  qc15_3  qc17_1  qc17_2  qc17_3  qc17_5  qc18_1r  qc18_2r  qc18_3r  qc20  d1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>imputed_data <span class="ot">&lt;-</span> <span class="fu">complete</span>(imputed_rf)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace non imputed columns with imputed ones</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>imputed_vars <span class="ot">&lt;-</span> <span class="fu">names</span>(imputed_data)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>selected_data <span class="ot">&lt;-</span> selected_data[, <span class="sc">!</span>(<span class="fu">names</span>(selected_data) <span class="sc">%in%</span> imputed_vars)]</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>selected_data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(selected_data, imputed_data)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(selected_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  uniqid      geo      d11    qc2_1    qc2_2    qc2_3    qc2_4    qc2_5 
       0        0        0        0        0        0        0        0 
   qc2_6    qc2_7    qc2_8    qc2_9   qc2_10   qc2_11   qc2_12   qc2_13 
       0        0        0        0        0        0        0        0 
  qc2_14   qc2_15   qc2_16   qc17_4     qc19      d10     d15a      d60 
       0        0        0        0        0        0        0        0 
   d62_1      p3r       p5       p4  COUNTRY      d70      qa1  polintr 
       0        0        0        0     3575        0        0        0 
     d63    d72_1    d72_2      sd3    sd1_7      d25       d8    qc1_4 
       0        0        0        0        0        0        0        0 
   qc1_8   qc6_1r   qc6_2r   qc6_3r  qc6_10r      qc7    qc9_1    qc9_4 
       0        0        0        0        0        0        0        0 
   qc9_5   qc9_10    qc5_1    qc5_3  qc12_1r  qc12_2r  qc12_6r qc12_10r 
       0        0        0        0        0        0        0        0 
qc12_11r   qc15_1   qc15_2   qc15_3   qc17_1   qc17_2   qc17_3   qc17_5 
       0        0        0        0        0        0        0        0 
 qc18_1r  qc18_2r  qc18_3r     qc20       d1 
       0        0        0        0        0 </code></pre>
</div>
</div>
</section>
<section id="recode-variables" class="level2">
<h2 class="anchored" data-anchor-id="recode-variables">Recode variables</h2>
<p>We recode many variables as factors and label them to be able to analyse them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>recoded_data <span class="ot">&lt;-</span> selected_data <span class="sc">|&gt;</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">qc19 =</span> <span class="fu">factor</span>(</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">case_when</span>(</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>        qc19 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="dv">0</span>, <span class="co"># make No as zero </span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>        qc19 <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="cn">NA</span>, <span class="co"># make DK as NA</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>        qc19 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">1</span> <span class="co"># keep Yes as 1        </span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>      <span class="co"># label the values </span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>      ), </span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">qa1 =</span> <span class="fu">factor</span>(qa1, </span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A lot"</span>, <span class="st">"Somewhat"</span>, <span class="st">"Not really"</span>, <span class="st">"Not at all"</span>)),</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">qc2_sum =</span> qc2_1 <span class="sc">+</span> qc2_2 <span class="sc">+</span> qc2_3 <span class="sc">+</span> qc2_4 <span class="sc">+</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>              qc2_5 <span class="sc">+</span> qc2_6 <span class="sc">+</span> qc2_7 <span class="sc">+</span> qc2_8 <span class="sc">+</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>              qc2_9 <span class="sc">+</span> qc2_10 <span class="sc">+</span> qc2_11 <span class="sc">+</span> qc2_12 <span class="sc">+</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>              qc2_13 <span class="sc">+</span> qc2_14,</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">qc2_recode =</span> <span class="fu">case_when</span>(</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>      qc2_sum <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>      qc2_15 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>      qc2_16 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="cn">NA</span>),</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># qc6_recode  = mean(qc6_1, qc6_2),</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">d15a =</span> <span class="fu">factor</span>(d15a, <span class="at">ordered =</span> <span class="cn">FALSE</span> ),</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">d1 =</span> <span class="fu">replace</span>(d1, d1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">12</span>), <span class="cn">NA</span>),</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">d70 =</span> <span class="fu">factor</span>(d70, <span class="at">ordered =</span> F,</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Very"</span>, <span class="st">"Somewhat"</span>, <span class="st">"Not very"</span>, <span class="st">"Not at all"</span>)), </span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">polintr =</span> <span class="fu">factor</span>(polintr, <span class="at">ordered =</span> F,</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"frequently"</span>, <span class="st">"occasionally"</span>, <span class="st">"never"</span>)),</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">d63 =</span> <span class="fu">factor</span>(d63, <span class="at">ordered =</span> <span class="cn">FALSE</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Working class"</span>, <span class="st">"Lower middle class"</span>, <span class="st">"Middle class"</span>, <span class="st">"Upper middle class"</span>, <span class="st">"Higher class"</span>)),</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">d72_1 =</span> <span class="fu">factor</span>(d72_1, <span class="at">ordered =</span> <span class="cn">FALSE</span>, <span class="at">labels=</span> <span class="fu">c</span>(<span class="st">"Totally agree"</span>, <span class="st">"Agree"</span>, <span class="st">"Disagree"</span>, <span class="st">"Totally disagree"</span>)),</span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">d72_2 =</span> <span class="fu">factor</span>(d72_1, <span class="at">ordered =</span> <span class="cn">FALSE</span>, <span class="at">labels=</span> <span class="fu">c</span>(<span class="st">"Totally agree"</span>, <span class="st">"Agree"</span>, <span class="st">"Disagree"</span>, <span class="st">"Totally disagree"</span>)),</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd3 =</span> <span class="fu">factor</span>(sd3, <span class="at">ordered =</span> <span class="cn">FALSE</span>, <span class="at">labels=</span> <span class="fu">c</span>(<span class="st">"Catholic"</span>, <span class="st">"Orthodox Christian"</span>, <span class="st">"Prostetant"</span>, <span class="st">"Other Christian"</span>, <span class="st">"Jewish"</span>, <span class="st">"Muslim - Shia"</span>, <span class="st">"Muslin - Sunni"</span>, <span class="st">"Other Muslim"</span>, <span class="st">"Sikh"</span>, <span class="st">"Buddhist"</span>, <span class="st">"Hindu"</span>, <span class="st">"Atheist"</span>, <span class="st">"Agnostic"</span>)),</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd1_7 =</span> <span class="fu">factor</span>(sd1_7, <span class="at">ordered =</span> F, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"No"</span>)),</span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">d25 =</span> <span class="fu">factor</span>(d25, <span class="at">ordered =</span> F, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Rural area"</span>, <span class="st">"Small/medium town"</span>, <span class="st">"Large town"</span>)),</span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_group =</span> <span class="fu">cut</span>(d11, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">10</span>), <span class="at">include.lowest =</span> <span class="cn">TRUE</span>),</span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">school_group =</span> <span class="fu">cut</span>(d8, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">50</span>, <span class="at">by =</span> <span class="dv">5</span>), <span class="at">include.lowest =</span> <span class="cn">TRUE</span>),</span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">qc20 =</span> <span class="fu">factor</span>(qc20, <span class="at">ordered =</span> F, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"No"</span>))) </span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Join recoded data with countries data</span></span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>recoded_data <span class="ot">&lt;-</span> recoded_data <span class="sc">|&gt;</span> </span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(countries, <span class="at">by =</span> <span class="st">"geo"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="descriptive-analysis" class="level2">
<h2 class="anchored" data-anchor-id="descriptive-analysis">Descriptive analysis</h2>
<section id="individual-characteristics" class="level3">
<h3 class="anchored" data-anchor-id="individual-characteristics">Individual characteristics</h3>
<p>Most people answer “yes” to our target question (52.7%), but there are also a significant amount of ‘no’ (35%) and ‘dont know’ answers (11.9%).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(recoded_data<span class="sc">$</span>qc19, <span class="at">useNA =</span> <span class="st">"ifany"</span>)) <span class="sc">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
      No      Yes     &lt;NA&gt; 
35.33421 52.71157 11.95422 </code></pre>
</div>
</div>
<p>Now, we will visualize some plots crossing the answers in QC19 to other variables.</p>
<ul>
<li><p>age_group- Age. In younger ages more people tend to answer ‘yes’, which means, more people are in favor of allowing trans people to change their documents. As the age increases, the ‘yes’ answer is less likely, but still over 50%. The number of NAs also increase with age, with a peak between 60 and 70 years old.</p></li>
<li><p>sd3 - Religion. La mayoría de personas de la muestra se consideran católicas. De éstas, un 56% está a favor frente un 43% en contra. La identidad en la cual hay más personas en contra, con un 57%, es orthodox christian. In the other hand, there are more individuals who agree who are Agnostic and atheists (Sikh too but there are very few cases in the sample, it’s not representative).</p></li>
<li><p>sd1_7 - Friend/acquaintance who is trans. A 89.8% of europeans don’t have a trans friend or aqcuaintance. However, from the people who don’t know a trans person, 80% of them are in favor of trans people changing their document, a much higher percentage than the 57% between the people who do know a trans person.</p></li>
<li><p>qc2_recode - Suffered discrimination. Most people haven’t suffered discrimination. The amount of people who is for and against the target question is very similar in both groups.</p></li>
<li><p>polintr - Political interest. More people who never get involved in political topics answered ‘don’t know’ proportionally than in the rest of categories. Thy’re also the individuals with a higher rate of ‘no’ answers. There are more people who answer ‘no’ and have a frequent interest in politics compared to people who have an ocasional interest.</p></li>
<li><p>qa1 - Opinion on international trade. People who consider they benefit a lot from international trade allowed by the EU tend to be more positive regarding our target variable. However, as the perception of trade decreases, so does the amount of people who are in favor, as well as people who don’t answer.</p></li>
<li><p>d25 - Type of city. There is more people against trans people changing their documents in rural areas, as well as in large towns compared to medium-sized cities.</p></li>
<li><p>d10 - Gender. More women than men answered ‘yes’ in the target variable.</p></li>
<li><p>school_group- Age when stopped education. This variable can be colineal with age. People who abandoned education very young are less suportive. The older the age, the more the support.</p></li>
<li><p>d63 - Subjective social class. A 27% of people define themselves as working class, more than lower middle class. The most common one is middle class. Only 0,6% of people consider themselves higher class. The least supportive class is working class, and as the class level increases so does the support.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sd3 - Religion</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(recoded_data<span class="sc">$</span>sd3, recoded_data<span class="sc">$</span>qc19), <span class="at">margin =</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    
                           No      Yes
  Catholic           43.07884 56.92116
  Orthodox Christian 58.20979 41.79021
  Prostetant         30.16039 69.83961
  Other Christian    42.62590 57.37410
  Jewish             36.20690 63.79310
  Muslim - Shia      45.45455 54.54545
  Muslin - Sunni     53.14685 46.85315
  Other Muslim       50.00000 50.00000
  Sikh               23.07692 76.92308
  Buddhist           33.33333 66.66667
  Hindu              42.85714 57.14286
  Atheist            26.90802 73.09198
  Agnostic           27.68128 72.31872</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sd1_7 - Friend/acquintance who is trans</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(recoded_data<span class="sc">$</span>sd1_7))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Yes       No 
0.100882 0.899118 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(recoded_data<span class="sc">$</span>sd1_7, recoded_data<span class="sc">$</span>qc19), <span class="at">margin =</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     
            No      Yes
  Yes 19.46698 80.53302
  No  42.61208 57.38792</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># qc2_recode  - Experienced discrimination</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(recoded_data<span class="sc">$</span>qc2_recode, recoded_data<span class="sc">$</span>qc19), <span class="at">margin =</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
          No      Yes
  0 40.18673 59.81327
  1 39.22855 60.77145</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># school_group  - Age finished education</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(recoded_data<span class="sc">$</span>school_group, recoded_data<span class="sc">$</span>qc19), <span class="at">margin =</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         
                No      Yes
  [1,6]   54.05405 45.94595
  (6,11]  49.04943 50.95057
  (11,16] 42.40138 57.59862
  (16,21] 44.35021 55.64979
  (21,26] 31.67555 68.32445
  (26,31] 24.71795 75.28205
  (31,36] 24.73868 75.26132
  (36,41] 24.09639 75.90361
  (41,46] 37.96296 62.03704</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># d63  - Subjective social class</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(recoded_data<span class="sc">$</span>d63))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Working class Lower middle class       Middle class Upper middle class 
       0.274947154        0.154493768        0.494095780        0.070595524 
      Higher class 
       0.005867775 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(recoded_data<span class="sc">$</span>d63, recoded_data<span class="sc">$</span>qc19), <span class="at">margin =</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    
                           No      Yes
  Working class      46.05472 53.94528
  Lower middle class 43.04813 56.95187
  Middle class       37.84870 62.15130
  Upper middle class 30.13393 69.86607
  Higher class       24.34211 75.65789</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"age_group"</span>, <span class="st">"polintr"</span>, <span class="st">"qa1"</span>, <span class="st">"d25"</span>, <span class="st">"d10"</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Lista para almacenar los gráficos</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>plots <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Generar gráficos para cada variable</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (variable <span class="cf">in</span> variables) {</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(recoded_data, <span class="fu">aes_string</span>(<span class="at">x =</span> variable, <span class="at">fill =</span> <span class="st">"qc19"</span>)) <span class="sc">+</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">"Variable"</span>, variable), <span class="at">y =</span> <span class="st">"Conteo"</span>, <span class="at">fill =</span> <span class="st">"Variable cq19"</span>) <span class="sc">+</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>  plots[[variable]] <span class="ot">&lt;-</span> plot</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `aes_string()` was deprecated in ggplot2 3.0.0.
ℹ Please use tidy evaluation idioms with `aes()`.
ℹ See also `vignette("ggplot2-in-packages")` for more information.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar los gráficos en una cuadrícula</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(<span class="at">plotlist =</span> plots, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="project_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
<section id="countries-descriptive-analysis" class="level3">
<h3 class="anchored" data-anchor-id="countries-descriptive-analysis">Countries descriptive analysis</h3>
<ul>
<li><p>geo - By country. We observe that the least suporting country is Hungary with a 84% of people against, meanwhile the most supporting one is Spain.</p></li>
<li><p>Marriage. 42% of the European countries allow homosexual marriage. From countries which don’t, there’s a majority of people (59%) who are against trans people documentation change. However, in countries which do allow homosexual marriage, have a majority of 76% in favor.</p></li>
<li><p>Gini coefficient value. At first glance, there doesn’t seem to be a clear tendency. Visually we can’t detect right now wheter a higher or lower gini score is related to more or less support.</p></li>
<li><p>Hate crime laws. More than half of the European countries have hate crime laws (54%). In this case, both groups of countries have a similar response ratio, with a 3% more of people being in favor of our target question in the countries with these laws.</p></li>
<li><p>Banned conversion therapies. Only a 3% of countries had banned them in 2019. There’s a big difference between both groups. In countries were they’ve been banned, a 85% of people agrees with allowing trans people change their documentation.</p></li>
<li><p>Existence of gender recogition administrative procedures. They are present in a 81% of countries. In countries where they don’t exist, a 62% of people are against; meanwhile, a 60% of people are on favor on countries where they do.</p></li>
<li><p>No medical diagnosis needed for documentation changes. Only a 30% of countries allowed this in 2019. In countries where they allow it, a 79% of people is in favour, compared to the 48% of countries where they don’t.</p></li>
<li><p>Dephatologisation. Only 6% of countries had specific laws regarding the dephatologisation of trans identities. In these few countries there’s also a much higher acceptance: 80% in favour.</p></li>
</ul>
<p>It’s easy to tell that anti-discrimination laws are reflected in an increase in the acceptance of transgender individuals in the population of these countries.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># By country</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> recoded_data, <span class="fu">aes</span>(<span class="at">x =</span> geo, <span class="at">fill =</span> <span class="fu">factor</span>(qc19))) <span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>)<span class="sc">+</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"País"</span>, <span class="at">y =</span> <span class="st">"Proporción"</span>, <span class="at">fill =</span> <span class="st">"Valor en qc19"</span>) <span class="sc">+</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="project_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="1152"></p>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(recoded_data<span class="sc">$</span>geo, recoded_data<span class="sc">$</span>qc19), <span class="at">margin =</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      
              No       Yes
  AT   38.453501 61.546499
  BE   27.218935 72.781065
  BG   83.333333 16.666667
  CY   46.115288 53.884712
  CZ   55.277476 44.722524
  DE-E 23.413567 76.586433
  DE-W 19.634703 80.365297
  DK   20.322581 79.677419
  EE   38.729763 61.270237
  ES    9.663409 90.336591
  FI   28.992072 71.007928
  FR   20.983607 79.016393
  GB   29.855716 70.144284
  GR   40.195016 59.804984
  HR   54.605263 45.394737
  HU   84.053156 15.946844
  IE   26.757370 73.242630
  IT   52.305962 47.694038
  LT   57.344301 42.655699
  LU   21.153846 78.846154
  LV   51.593861 48.406139
  MT   14.732143 85.267857
  NL   13.367347 86.632653
  PL   50.000000 50.000000
  PT   22.502744 77.497256
  RO   76.132597 23.867403
  SE   27.827051 72.172949
  SI   47.173913 52.826087
  SK   70.090293 29.909707</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Marriage</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(countries<span class="sc">$</span>Marriage))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
        0         1 
0.5757576 0.4242424 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(recoded_data<span class="sc">$</span>Marriage, recoded_data<span class="sc">$</span>qc19), <span class="at">margin =</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
          No      Yes
  0 59.48100 40.51900
  1 23.09274 76.90726</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gini value</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">as.data.frame.table</span>(<span class="fu">prop.table</span>(<span class="fu">table</span>(recoded_data<span class="sc">$</span>OBS_VALUE, recoded_data<span class="sc">$</span>qc19), <span class="at">margin =</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data, <span class="fu">aes</span>(<span class="at">x =</span> Var1, <span class="at">y =</span> Freq, <span class="at">color =</span> Var2, <span class="at">group =</span> Var2)) <span class="sc">+</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"OBS_VALUE"</span>, <span class="at">y =</span> <span class="st">"Proporción (%)"</span>, <span class="at">color =</span> <span class="st">"Valor en qc19"</span>) <span class="sc">+</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"No"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Yes"</span> <span class="ot">=</span> <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="project_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid" width="1152"></p>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Hate Crime Laws`</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(countries<span class="sc">$</span><span class="st">`</span><span class="at">Hate Crime Laws</span><span class="st">`</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
        0         1 
0.4545455 0.5454545 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(recoded_data<span class="sc">$</span><span class="st">`</span><span class="at">Hate Crime Laws</span><span class="st">`</span>, recoded_data<span class="sc">$</span>qc19), <span class="at">margin =</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
          No      Yes
  0 43.25642 56.74358
  1 40.44030 59.55970</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Banned Conversion Therapies</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(countries<span class="sc">$</span><span class="st">`</span><span class="at">Banned Conversion Therapies</span><span class="st">`</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
         0          1 
0.96969697 0.03030303 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(recoded_data<span class="sc">$</span><span class="st">`</span><span class="at">Banned Conversion Therapies</span><span class="st">`</span>, recoded_data<span class="sc">$</span>qc19), <span class="at">margin =</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
          No      Yes
  0 42.37824 57.62176
  1 14.73214 85.26786</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Existence of gender recogition administrative procedures</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(countries<span class="sc">$</span><span class="st">`</span><span class="at">Existence of gender recogition administrative procedures</span><span class="st">`</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
        0         1 
0.1818182 0.8181818 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(recoded_data<span class="sc">$</span><span class="st">`</span><span class="at">Existence of gender recogition administrative procedures</span><span class="st">`</span>, recoded_data<span class="sc">$</span>qc19), <span class="at">margin =</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
          No      Yes
  0 62.29839 37.70161
  1 39.64874 60.35126</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># No medical diagnosis needed</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(countries<span class="sc">$</span><span class="st">`</span><span class="at">No medical diag0sis needed</span><span class="st">`</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
        0         1 
0.6969697 0.3030303 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(recoded_data<span class="sc">$</span><span class="st">`</span><span class="at">No medical diag0sis needed</span><span class="st">`</span>, recoded_data<span class="sc">$</span>qc19), <span class="at">margin =</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
          No      Yes
  0 51.15766 48.84234
  1 20.83526 79.16474</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Depathologisation</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(countries<span class="sc">$</span><span class="st">`</span><span class="at">Depathologisation</span><span class="st">`</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
         0          1 
0.93939394 0.06060606 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(recoded_data<span class="sc">$</span><span class="st">`</span><span class="at">Depathologisation</span><span class="st">`</span>, recoded_data<span class="sc">$</span>qc19), <span class="at">margin =</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
          No      Yes
  0 43.30007 56.69993
  1 19.94113 80.05887</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Marriage"</span>, <span class="st">"`Hate Crime Laws`"</span>, <span class="st">"`Banned Conversion Therapies`"</span>, <span class="st">"`Existence of gender recogition administrative procedures`"</span>, <span class="st">"`No medical diag0sis needed`"</span>, <span class="st">"`Depathologisation`"</span>)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Lista para almacenar los gráficos</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>plots <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Generar gráficos para cada variable</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (variable <span class="cf">in</span> variables) {</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>  plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(recoded_data, <span class="fu">aes_string</span>(<span class="at">x =</span> variable, <span class="at">fill =</span> <span class="st">"qc19"</span>)) <span class="sc">+</span></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">"Variable"</span>, variable), <span class="at">y =</span> <span class="st">"Conteo"</span>, <span class="at">fill =</span> <span class="st">"Variable cq19"</span>) <span class="sc">+</span></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>  plots[[variable]] <span class="ot">&lt;-</span> plot</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar los gráficos en una cuadrícula</span></span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(<span class="at">plotlist =</span> plots, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="project_files/figure-html/unnamed-chunk-9-3.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
</section>
<section id="modeling" class="level2">
<h2 class="anchored" data-anchor-id="modeling">Modeling</h2>
<p>In this part, we will build multivariate logistic regression models to estimate the effects our predictors have on the outome variable. We have included mixed-effect models, in which the random effects will be countries, age groups, levels of educational attainment, religion and city type.</p>
<p>Our outcome variable, <code>qc19,</code> measures the odds/probability that an individual is in favor of changing the laws to allow transgender people the right to change their civil documents. In other words, this variable can be used to measure <strong>transphobia</strong>, which is defined as the dislike of or prejudice against transgender people.</p>
<p>Here are the various predictor variables we have chosen to include in the models. The data were taken from the 2019 survey conducted by the European Union.</p>
<ul>
<li><p>life satisfaction– factor <code>d70</code></p>
<ul>
<li>“Very,” “Somewhat,” “Not really,” or “Not at all satisfied”</li>
</ul></li>
<li><p>politcial interest– factor <code>polintr</code></p>
<ul>
<li>“Frequently,” “Occasionally,” or “Never” talk about politics</li>
</ul></li>
<li><p>opinion on globalization– factor <code>qa1</code></p>
<ul>
<li>Globalization is benefitting me “a lot,” “somewhat,” “not really,” or “nor at all”</li>
</ul></li>
</ul>
<section id="split-trainingtesting-data" class="level3">
<h3 class="anchored" data-anchor-id="split-trainingtesting-data">Split training/testing data</h3>
<p>We split our data into a training and testing set. The training set will get 70% of data. This will allow us to test our model accuracy later with ‘new’ data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>in.train <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(recoded_data<span class="sc">$</span>qc19, <span class="at">p =</span> .<span class="dv">7</span>, <span class="at">list =</span> F)</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>training.data <span class="ot">&lt;-</span> recoded_data[in.train[,<span class="dv">1</span>], ]</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>testing.data <span class="ot">&lt;-</span> recoded_data[<span class="sc">-</span>in.train[,<span class="dv">1</span>], ]</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(training.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 19208</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(testing.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8230</code></pre>
</div>
</div>
</section>
<section id="binomial-logistic-models" class="level3">
<h3 class="anchored" data-anchor-id="binomial-logistic-models">Binomial logistic models</h3>
<p>According to the models below, <strong>life satisfaction</strong> has a strong effect on an individual’s opinion about transgender rights. The model results show that respondents who said that they are “not very” and “not at all” satisfied with their life are much more likely to answer “No” to the question about giving transgender people the right to change their civil documents. The coefficients show that both negative responses have a similar effect on the odds that they will answer Yes/No.&nbsp;Respondents who answered “somewhat satisfied” are also more likely to answer “No” but not by much.</p>
<p>Other predictors <strong>Age</strong>, <strong>Political Interest</strong>, and <strong>Country</strong> also show a strong effect on the outcome.</p>
<p>Including all our variables into the model, we observe many aren’t significant. We reduce the variables until we select only those which are.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>modelo <span class="ot">&lt;-</span> <span class="fu">glm</span>(qc19 <span class="sc">~</span> d70 <span class="sc">+</span> qa1 <span class="sc">+</span> polintr <span class="sc">+</span> d63 <span class="sc">+</span> d72_1 <span class="sc">+</span> d72_2 <span class="sc">+</span> sd3 <span class="sc">+</span> sd1_7 <span class="sc">+</span> d25 <span class="sc">+</span> d8 <span class="sc">+</span> qc1_4 <span class="sc">+</span> qc1_8 <span class="sc">+</span> qc6_1r <span class="sc">+</span> qc6_2r <span class="sc">+</span> qc6_3r <span class="sc">+</span> qc6_10r <span class="sc">+</span> qc7 <span class="sc">+</span> qc9_1 <span class="sc">+</span> qc9_4 <span class="sc">+</span> qc9_5 <span class="sc">+</span> qc9_10 <span class="sc">+</span> qc5_1 <span class="sc">+</span> qc5_3 <span class="sc">+</span> qc12_1r <span class="sc">+</span> qc12_2r <span class="sc">+</span> qc12_6r <span class="sc">+</span> qc12_10r <span class="sc">+</span> qc12_11r <span class="sc">+</span> qc15_1 <span class="sc">+</span> qc15_2 <span class="sc">+</span> qc15_3 <span class="sc">+</span> qc17_1 <span class="sc">+</span> qc17_2 <span class="sc">+</span> qc17_3 <span class="sc">+</span> qc17_3 <span class="sc">+</span> qc17_5 <span class="sc">+</span> qc18_1r <span class="sc">+</span> qc18_2r <span class="sc">+</span> qc18_3r <span class="sc">+</span> qc20 <span class="sc">+</span> d1 <span class="sc">+</span> qc2_recode <span class="sc">+</span> sd1_7 <span class="sc">+</span> d25 <span class="sc">+</span> Marriage <span class="sc">+</span> <span class="st">`</span><span class="at">Hate Crime Laws</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">Banned Conversion Therapies</span><span class="st">`</span> <span class="sc">+</span>  <span class="st">`</span><span class="at">Existence of gender recogition administrative procedures</span><span class="st">`</span><span class="sc">+</span> <span class="st">`</span><span class="at">No medical diag0sis needed</span><span class="st">`</span> <span class="sc">+</span>  <span class="st">`</span><span class="at">Depathologisation</span><span class="st">`</span>, <span class="at">data =</span> recoded_data, <span class="at">family =</span> binomial)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>threshold <span class="ot">=</span> <span class="fl">0.6</span> <span class="co"># set the threshold here </span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>probabilities <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo, <span class="at">newdata =</span> recoded_data, <span class="at">type =</span> <span class="st">"response"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
prediction from a rank-deficient fit may be misleading</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">ifelse</span>(probabilities <span class="sc">&gt;=</span> threshold, <span class="st">"Yes"</span>, <span class="st">"No"</span>))</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(predictions, recoded_data<span class="sc">$</span>qc19)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   No  Yes
       No  7456 2589
       Yes 1258 9599
                                          
               Accuracy : 0.816           
                 95% CI : (0.8106, 0.8212)
    No Information Rate : 0.5831          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.6295          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.8556          
            Specificity : 0.7876          
         Pos Pred Value : 0.7423          
         Neg Pred Value : 0.8841          
             Prevalence : 0.4169          
         Detection Rate : 0.3567          
   Detection Prevalence : 0.4806          
      Balanced Accuracy : 0.8216          
                                          
       'Positive' Class : No              
                                          </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(qc19 <span class="sc">~</span> d11 <span class="sc">+</span> d70,</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> recoded_data, <span class="at">family =</span> binomial)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(qc19 <span class="sc">~</span> geo <span class="sc">+</span> sd3, </span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> recoded_data, <span class="at">family =</span> binomial)</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>model7 <span class="ot">&lt;-</span> <span class="fu">glm</span>(qc19 <span class="sc">~</span> d70 <span class="sc">+</span> qa1 <span class="sc">+</span> d63 <span class="sc">+</span> sd3 <span class="sc">+</span> sd1_7 <span class="sc">+</span> d8 <span class="sc">+</span> qc1_4 <span class="sc">+</span> qc1_8 <span class="sc">+</span> qc6_1r <span class="sc">+</span> qc6_2r <span class="sc">+</span> qc6_3r <span class="sc">+</span> qc6_10r <span class="sc">+</span> qc7 <span class="sc">+</span> qc9_1 <span class="sc">+</span> qc5_1 <span class="sc">+</span> qc5_3 <span class="sc">+</span> qc12_10r <span class="sc">+</span> qc15_1 <span class="sc">+</span> qc15_2 <span class="sc">+</span> qc15_3 <span class="sc">+</span> qc17_2  <span class="sc">+</span> qc17_5 <span class="sc">+</span> qc20 <span class="sc">+</span> d1 <span class="sc">+</span> d11  <span class="sc">+</span> qc2_recode <span class="sc">+</span> <span class="sc">+</span> Marriage <span class="sc">+</span> <span class="st">`</span><span class="at">Hate Crime Laws</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">Existence of gender recogition administrative procedures</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">No medical diag0sis needed</span><span class="st">`</span> <span class="sc">+</span> Depathologisation <span class="sc">+</span> OBS_VALUE, </span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> training.data, <span class="at">family =</span> binomial</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="mixed-models" class="level3">
<h3 class="anchored" data-anchor-id="mixed-models">Mixed models</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Matrix</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'Matrix'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:tidyr':

    expand, pack, unpack</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reversing the order of levels for knowing a trans person. No is base.</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>recoded_data<span class="sc">$</span>know_transperson <span class="ot">&lt;-</span> <span class="fu">factor</span>(recoded_data<span class="sc">$</span>sd1_7, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>) )</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(recoded_data<span class="sc">$</span>know_transperson)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "No"  "Yes"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>mixed_model6 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(qc19 <span class="sc">~</span> d70 <span class="sc">+</span> qa1<span class="sc">+</span> polintr <span class="sc">+</span> d72_1 <span class="sc">+</span> d72_2  <span class="sc">+</span> d10 <span class="sc">+</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>                        know_transperson <span class="sc">+</span> d25 <span class="sc">+</span> d8 <span class="sc">+</span> d25 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>sd3) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>geo), </span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> recoded_data, <span class="at">family =</span> binomial</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>fixed-effect model matrix is rank deficient so dropping 3 columns / coefficients</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>stargazer<span class="sc">::</span><span class="fu">stargazer</span>(model1, model2, model7, mixed_model6, <span class="at">type =</span> <span class="st">"text"</span>, <span class="at">model.names =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=================================================================================================================
                                                                             Dependent variable:                 
                                                            -----------------------------------------------------
                                                                                    qc19                         
                                                                         logistic              generalized linear
                                                                                               mixed-effects
                                                                (1)         (2)        (3)            (4)        
-----------------------------------------------------------------------------------------------------------------
d11                                                          -0.005***               0.004***                    
                                                              (0.001)                (0.001)                     
                                                                                                                 
qc2_recode                                                                           -0.173**                    
                                                                                     (0.070)                     
                                                                                                                 
Marriage1                                                                             0.105                      
                                                                                     (0.081)                     
                                                                                                                 
`Hate Crime Laws`1                                                                  -0.204***                    
                                                                                     (0.059)                     
                                                                                                                 
`Existence of gender recogition administrative procedures`1                          -0.260**                    
                                                                                     (0.109)                     
                                                                                                                 
`No medical diag0sis needed`1                                                        0.593***                    
                                                                                     (0.089)                     
                                                                                                                 
Depathologisation1                                                                   0.835***                    
                                                                                     (0.122)                     
                                                                                                                 
OBS_VALUE                                                                            0.023***                    
                                                                                     (0.008)                     
                                                                                                                 
d70Somewhat                                                  -0.432***                -0.004         -0.030      
                                                              (0.032)                (0.060)        (0.038)      
                                                                                                                 
d70Not very                                                  -1.098***              -0.272***      -0.317***     
                                                              (0.045)                (0.088)        (0.055)      
                                                                                                                 
d70Not at all                                                -1.380***               -0.369**      -0.411***     
                                                              (0.076)                (0.147)        (0.091)      
                                                                                                                 
geoBE                                                                    0.467***                                
                                                                          (0.098)                                
                                                                                                                 
geoBG                                                                    -1.848***                               
                                                                          (0.130)                                
                                                                                                                 
geoCY                                                                     -0.055                                 
                                                                          (0.135)                                
                                                                                                                 
geoCZ                                                                    -0.930***                               
                                                                          (0.097)                                
                                                                                                                 
geoDE-E                                                                  0.486***                                
                                                                          (0.132)                                
                                                                                                                 
geoDE-W                                                                  0.907***                                
                                                                          (0.109)                                
                                                                                                                 
geoDK                                                                    0.806***                                
                                                                          (0.112)                                
                                                                                                                 
geoEE                                                                     -0.068                                 
                                                                          (0.102)                                
                                                                                                                 
geoES                                                                    1.716***                                
                                                                          (0.130)                                
                                                                                                                 
geoFI                                                                    0.334***                                
                                                                          (0.107)                                
                                                                                                                 
geoFR                                                                    0.768***                                
                                                                          (0.106)                                
                                                                                                                 
geoGB                                                                    0.327***                                
                                                                          (0.102)                                
                                                                                                                 
geoGR                                                                     0.185*                                 
                                                                          (0.112)                                
                                                                                                                 
geoHR                                                                    -0.622***                               
                                                                          (0.095)                                
                                                                                                                 
geoHU                                                                    -2.155***                               
                                                                          (0.113)                                
                                                                                                                 
geoIE                                                                    0.574***                                
                                                                          (0.102)                                
                                                                                                                 
geoIT                                                                    -0.551***                               
                                                                          (0.095)                                
                                                                                                                 
geoLT                                                                    -0.716***                               
                                                                          (0.097)                                
                                                                                                                 
geoLU                                                                    0.810***                                
                                                                          (0.132)                                
                                                                                                                 
geoLV                                                                    -0.526***                               
                                                                          (0.098)                                
                                                                                                                 
geoMT                                                                    1.366***                                
                                                                          (0.150)                                
                                                                                                                 
geoNL                                                                    1.229***                                
                                                                          (0.117)                                
                                                                                                                 
geoPL                                                                    -0.413***                               
                                                                          (0.097)                                
                                                                                                                 
geoPT                                                                    0.800***                                
                                                                          (0.104)                                
                                                                                                                 
geoRO                                                                    -1.384***                               
                                                                          (0.116)                                
                                                                                                                 
geoSE                                                                    0.280***                                
                                                                          (0.104)                                
                                                                                                                 
geoSI                                                                    -0.350***                               
                                                                          (0.095)                                
                                                                                                                 
geoSK                                                                    -1.304***                               
                                                                          (0.100)                                
                                                                                                                 
qa1Somewhat                                                                          -0.163**      -0.182***     
                                                                                     (0.069)        (0.044)      
                                                                                                                 
qa1Not really                                                                       -0.210***      -0.449***     
                                                                                     (0.080)        (0.051)      
                                                                                                                 
qa1Not at all                                                                        -0.222**      -0.478***     
                                                                                     (0.090)        (0.057)      
                                                                                                                 
d63Lower middle class                                                                 0.100                      
                                                                                     (0.077)                     
                                                                                                                 
d63Middle class                                                                       0.091                      
                                                                                     (0.061)                     
                                                                                                                 
d63Upper middle class                                                                 0.062                      
                                                                                     (0.104)                     
                                                                                                                 
d63Higher class                                                                       0.481*                     
                                                                                     (0.287)                     
                                                                                                                 
sd3Orthodox Christian                                                    -0.193***  -0.236***                    
                                                                          (0.069)    (0.086)                     
                                                                                                                 
sd3Prostetant                                                             0.144**     0.115                      
                                                                          (0.061)    (0.087)                     
                                                                                                                 
sd3Other Christian                                                        -0.118      0.030                      
                                                                          (0.074)    (0.115)                     
                                                                                                                 
sd3Jewish                                                                  0.365      0.346                      
                                                                          (0.303)    (0.515)                     
                                                                                                                 
sd3Muslim - Shia                                                          -0.198      -0.292                     
                                                                          (0.253)    (0.404)                     
                                                                                                                 
sd3Muslin - Sunni                                                        -0.695***  -1.235***                    
                                                                          (0.183)    (0.343)                     
                                                                                                                 
sd3Other Muslim                                                           -0.255      -0.315                     
                                                                          (0.213)    (0.359)                     
                                                                                                                 
sd3Sikh                                                                    0.635      -0.592                     
                                                                          (0.671)    (1.212)                     
                                                                                                                 
sd3Buddhist                                                                0.078      0.034                      
                                                                          (0.294)    (0.522)                     
                                                                                                                 
sd3Hindu                                                                  -0.232      0.625                      
                                                                          (0.408)    (0.763)                     
                                                                                                                 
sd3Atheist                                                               0.588***    0.279***                    
                                                                          (0.061)    (0.095)                     
                                                                                                                 
sd3Agnostic                                                              0.499***    0.196**                     
                                                                          (0.051)    (0.077)                     
                                                                                                                 
sd1_7No                                                                             -0.296***                    
                                                                                     (0.090)                     
                                                                                                                 
polintroccasionally                                                                                  -0.024      
                                                                                                    (0.040)      
                                                                                                                 
polintrnever                                                                                        -0.118**     
                                                                                                    (0.049)      
                                                                                                                 
d72_1Agree                                                                                         -0.180***     
                                                                                                    (0.045)      
                                                                                                                 
d72_1Disagree                                                                                      -0.377***     
                                                                                                    (0.049)      
                                                                                                                 
d72_1Totally disagree                                                                              -0.543***     
                                                                                                    (0.053)      
                                                                                                                 
d10                                                                                                 0.434***     
                                                                                                    (0.030)      
                                                                                                                 
know_transpersonYes                                                                                 0.780***     
                                                                                                    (0.057)      
                                                                                                                 
d25Small/medium town                                                                                0.074**      
                                                                                                    (0.037)      
                                                                                                                 
d25Large town                                                                                       0.133***     
                                                                                                    (0.040)      
                                                                                                                 
d8                                                                                   0.010**        0.018***     
                                                                                     (0.004)        (0.003)      
                                                                                                                 
qc1_4                                                                                -0.075**                    
                                                                                     (0.034)                     
                                                                                                                 
qc1_8                                                                                 0.048                      
                                                                                     (0.033)                     
                                                                                                                 
qc6_1r                                                                               0.265***                    
                                                                                     (0.058)                     
                                                                                                                 
qc6_2r                                                                                0.060                      
                                                                                     (0.043)                     
                                                                                                                 
qc6_3r                                                                                -0.037                     
                                                                                     (0.035)                     
                                                                                                                 
qc6_10r                                                                              0.103***                    
                                                                                     (0.039)                     
                                                                                                                 
qc7                                                                                   -0.016                     
                                                                                     (0.011)                     
                                                                                                                 
qc9_1                                                                                 -0.013                     
                                                                                     (0.024)                     
                                                                                                                 
qc5_1                                                                               -0.290***                    
                                                                                     (0.089)                     
                                                                                                                 
qc5_3                                                                                 0.168                      
                                                                                     (0.113)                     
                                                                                                                 
qc12_10r                                                                             0.100***                    
                                                                                     (0.026)                     
                                                                                                                 
qc15_1                                                                              -0.272***                    
                                                                                     (0.035)                     
                                                                                                                 
qc15_2                                                                              -0.117***                    
                                                                                     (0.039)                     
                                                                                                                 
qc15_3                                                                              -0.196***                    
                                                                                     (0.037)                     
                                                                                                                 
qc17_2                                                                              -0.148***                    
                                                                                     (0.035)                     
                                                                                                                 
qc17_5                                                                              -0.209***                    
                                                                                     (0.031)                     
                                                                                                                 
qc20No                                                                              -2.667***                    
                                                                                     (0.056)                     
                                                                                                                 
d1                                                                                   -0.019*                     
                                                                                     (0.011)                     
                                                                                                                 
Constant                                                     1.091***    0.382***    2.745***        -0.160      
                                                              (0.046)     (0.068)    (0.452)        (0.220)      
                                                                                                                 
-----------------------------------------------------------------------------------------------------------------
Observations                                                  24,158      24,158      14,639         24,158      
Log Likelihood                                              -15,835.320 -13,898.640 -5,737.308    -13,488.420    
Akaike Inf. Crit.                                           31,680.650  27,879.270  11,576.620     27,014.840    
Bayesian Inf. Crit.                                                                                27,168.600    
=================================================================================================================
Note:                                                                                 *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
<section id="visualizing-the-model" class="level4">
<h4 class="anchored" data-anchor-id="visualizing-the-model">Visualizing the model</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">plot_model</span>(model2, <span class="at">type =</span> <span class="st">"pred"</span>, </span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">terms =</span>  <span class="st">"sd3"</span>, <span class="at">ci.lvl =</span> <span class="fl">0.95</span>) <span class="sc">+</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Religion"</span>,</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Probability of Yes answer"</span>,</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Given their nationality, Sikhs have largest range at 95% confidence level "</span></span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="project_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="modelo" class="level2">
<h2 class="anchored" data-anchor-id="modelo">Modelo</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>modelo <span class="ot">&lt;-</span> <span class="fu">glm</span>(qc19 <span class="sc">~</span> d70 <span class="sc">+</span> qa1 <span class="sc">+</span> d63 <span class="sc">+</span> sd3 <span class="sc">+</span> sd1_7 <span class="sc">+</span> d8 <span class="sc">+</span> qc1_4 <span class="sc">+</span> qc1_8 <span class="sc">+</span> qc6_1r <span class="sc">+</span> qc6_2r <span class="sc">+</span> qc6_3r <span class="sc">+</span> qc6_10r <span class="sc">+</span> qc7 <span class="sc">+</span> qc9_1 <span class="sc">+</span> qc5_1 <span class="sc">+</span> qc12_10r <span class="sc">+</span> qc15_1 <span class="sc">+</span> qc15_2 <span class="sc">+</span> qc15_3 <span class="sc">+</span> qc17_2  <span class="sc">+</span> qc17_5 <span class="sc">+</span> qc20 <span class="sc">+</span> d1 <span class="sc">+</span> d11 <span class="sc">+</span> d8 <span class="sc">+</span> d10 <span class="sc">+</span> qc2_recode <span class="sc">+</span> sd1_7 <span class="sc">+</span>  <span class="st">`</span><span class="at">Hate Crime Laws</span><span class="st">`</span> <span class="sc">+</span>  <span class="st">`</span><span class="at">Existence of gender recogition administrative procedures</span><span class="st">`</span><span class="sc">+</span> <span class="st">`</span><span class="at">No medical diag0sis needed</span><span class="st">`</span> <span class="sc">+</span>  <span class="st">`</span><span class="at">Depathologisation</span><span class="st">`</span> <span class="sc">+</span> OBS_VALUE, </span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> training.data, <span class="at">family =</span> binomial)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = qc19 ~ d70 + qa1 + d63 + sd3 + sd1_7 + d8 + qc1_4 + 
    qc1_8 + qc6_1r + qc6_2r + qc6_3r + qc6_10r + qc7 + qc9_1 + 
    qc5_1 + qc12_10r + qc15_1 + qc15_2 + qc15_3 + qc17_2 + qc17_5 + 
    qc20 + d1 + d11 + d8 + d10 + qc2_recode + sd1_7 + `Hate Crime Laws` + 
    `Existence of gender recogition administrative procedures` + 
    `No medical diag0sis needed` + Depathologisation + OBS_VALUE, 
    family = binomial, data = training.data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.3021  -0.5910   0.2163   0.5036   2.6090  

Coefficients:
                                                             Estimate
(Intercept)                                                  2.602856
d70Somewhat                                                 -0.015385
d70Not very                                                 -0.276238
d70Not at all                                               -0.367115
qa1Somewhat                                                 -0.181776
qa1Not really                                               -0.228656
qa1Not at all                                               -0.236876
d63Lower middle class                                        0.089709
d63Middle class                                              0.082606
d63Upper middle class                                        0.088555
d63Higher class                                              0.456223
sd3Orthodox Christian                                       -0.231696
sd3Prostetant                                                0.172251
sd3Other Christian                                           0.053989
sd3Jewish                                                    0.356969
sd3Muslim - Shia                                            -0.257408
sd3Muslin - Sunni                                           -1.188755
sd3Other Muslim                                             -0.287762
sd3Sikh                                                     -0.475398
sd3Buddhist                                                  0.055279
sd3Hindu                                                     0.731217
sd3Atheist                                                   0.327691
sd3Agnostic                                                  0.244832
sd1_7No                                                     -0.282201
d8                                                           0.010404
qc1_4                                                       -0.070254
qc1_8                                                        0.048874
qc6_1r                                                       0.257750
qc6_2r                                                       0.054300
qc6_3r                                                      -0.035605
qc6_10r                                                      0.100485
qc7                                                         -0.016143
qc9_1                                                       -0.017383
qc5_1                                                       -0.243401
qc12_10r                                                     0.098650
qc15_1                                                      -0.277469
qc15_2                                                      -0.118625
qc15_3                                                      -0.195802
qc17_2                                                      -0.144030
qc17_5                                                      -0.211069
qc20No                                                      -2.667956
d1                                                          -0.018140
d11                                                          0.003846
d10                                                          0.278511
qc2_recode                                                  -0.191367
`Hate Crime Laws`1                                          -0.219831
`Existence of gender recogition administrative procedures`1 -0.230906
`No medical diag0sis needed`1                                0.694527
Depathologisation1                                           0.865374
OBS_VALUE                                                    0.022709
                                                            Std. Error z value
(Intercept)                                                   0.427717   6.085
d70Somewhat                                                   0.059795  -0.257
d70Not very                                                   0.087411  -3.160
d70Not at all                                                 0.146639  -2.504
qa1Somewhat                                                   0.068733  -2.645
qa1Not really                                                 0.080570  -2.838
qa1Not at all                                                 0.090543  -2.616
d63Lower middle class                                         0.077143   1.163
d63Middle class                                               0.060627   1.363
d63Upper middle class                                         0.104337   0.849
d63Higher class                                               0.287261   1.588
sd3Orthodox Christian                                         0.086390  -2.682
sd3Prostetant                                                 0.082523   2.087
sd3Other Christian                                            0.115139   0.469
sd3Jewish                                                     0.515373   0.693
sd3Muslim - Shia                                              0.406041  -0.634
sd3Muslin - Sunni                                             0.342043  -3.475
sd3Other Muslim                                               0.361255  -0.797
sd3Sikh                                                       1.252999  -0.379
sd3Buddhist                                                   0.522137   0.106
sd3Hindu                                                      0.757112   0.966
sd3Atheist                                                    0.095070   3.447
sd3Agnostic                                                   0.076766   3.189
sd1_7No                                                       0.090177  -3.129
d8                                                            0.004416   2.356
qc1_4                                                         0.034445  -2.040
qc1_8                                                         0.032587   1.500
qc6_1r                                                        0.058418   4.412
qc6_2r                                                        0.043505   1.248
qc6_3r                                                        0.035433  -1.005
qc6_10r                                                       0.038557   2.606
qc7                                                           0.011368  -1.420
qc9_1                                                         0.024053  -0.723
qc5_1                                                         0.084917  -2.866
qc12_10r                                                      0.026233   3.760
qc15_1                                                        0.034460  -8.052
qc15_2                                                        0.039351  -3.015
qc15_3                                                        0.037248  -5.257
qc17_2                                                        0.034943  -4.122
qc17_5                                                        0.030701  -6.875
qc20No                                                        0.056085 -47.570
d1                                                            0.010594  -1.712
d11                                                           0.001410   2.728
d10                                                           0.048040   5.798
qc2_recode                                                    0.069586  -2.750
`Hate Crime Laws`1                                            0.058060  -3.786
`Existence of gender recogition administrative procedures`1   0.107963  -2.139
`No medical diag0sis needed`1                                 0.068076  10.202
Depathologisation1                                            0.121361   7.131
OBS_VALUE                                                     0.007491   3.031
                                                            Pr(&gt;|z|)    
(Intercept)                                                 1.16e-09 ***
d70Somewhat                                                 0.796953    
d70Not very                                                 0.001576 ** 
d70Not at all                                               0.012296 *  
qa1Somewhat                                                 0.008178 ** 
qa1Not really                                               0.004540 ** 
qa1Not at all                                               0.008892 ** 
d63Lower middle class                                       0.244875    
d63Middle class                                             0.173032    
d63Upper middle class                                       0.396026    
d63Higher class                                             0.112245    
sd3Orthodox Christian                                       0.007319 ** 
sd3Prostetant                                               0.036861 *  
sd3Other Christian                                          0.639142    
sd3Jewish                                                   0.488534    
sd3Muslim - Shia                                            0.526117    
sd3Muslin - Sunni                                           0.000510 ***
sd3Other Muslim                                             0.425706    
sd3Sikh                                                     0.704385    
sd3Buddhist                                                 0.915685    
sd3Hindu                                                    0.334145    
sd3Atheist                                                  0.000567 ***
sd3Agnostic                                                 0.001426 ** 
sd1_7No                                                     0.001751 ** 
d8                                                          0.018468 *  
qc1_4                                                       0.041393 *  
qc1_8                                                       0.133665    
qc6_1r                                                      1.02e-05 ***
qc6_2r                                                      0.211985    
qc6_3r                                                      0.314972    
qc6_10r                                                     0.009158 ** 
qc7                                                         0.155600    
qc9_1                                                       0.469873    
qc5_1                                                       0.004153 ** 
qc12_10r                                                    0.000170 ***
qc15_1                                                      8.15e-16 ***
qc15_2                                                      0.002574 ** 
qc15_3                                                      1.47e-07 ***
qc17_2                                                      3.76e-05 ***
qc17_5                                                      6.20e-12 ***
qc20No                                                       &lt; 2e-16 ***
d1                                                          0.086826 .  
d11                                                         0.006365 ** 
d10                                                         6.73e-09 ***
qc2_recode                                                  0.005958 ** 
`Hate Crime Laws`1                                          0.000153 ***
`Existence of gender recogition administrative procedures`1 0.032456 *  
`No medical diag0sis needed`1                                &lt; 2e-16 ***
Depathologisation1                                          1.00e-12 ***
OBS_VALUE                                                   0.002435 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 19868  on 14638  degrees of freedom
Residual deviance: 11445  on 14589  degrees of freedom
  (4569 observations deleted due to missingness)
AIC: 11545

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>threshold <span class="ot">=</span> <span class="fl">0.6</span> <span class="co"># set the threshold here </span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>probabilities <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo, <span class="at">newdata =</span> testing.data, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">ifelse</span>(probabilities <span class="sc">&gt;=</span> threshold, <span class="st">"Yes"</span>, <span class="st">"No"</span>))</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>roc <span class="ot">&lt;-</span> pROC<span class="sc">::</span><span class="fu">roc</span>(testing.data<span class="sc">$</span>qc19, probabilities, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting levels: control = No, case = Yes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting direction: controls &lt; cases</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>sens <span class="ot">&lt;-</span> roc<span class="sc">$</span>sensitivities <span class="co">#include sensitivities in test data</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>spec <span class="ot">&lt;-</span> roc<span class="sc">$</span>specificities</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(model7<span class="sc">$</span>coefficients)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                (Intercept) 
                                                15.56447180 
                                                d70Somewhat 
                                                 0.99568017 
                                                d70Not very 
                                                 0.76191109 
                                              d70Not at all 
                                                 0.69128481 
                                                qa1Somewhat 
                                                 0.84951288 
                                              qa1Not really 
                                                 0.81042740 
                                              qa1Not at all 
                                                 0.80099607 
                                      d63Lower middle class 
                                                 1.10533145 
                                            d63Middle class 
                                                 1.09542017 
                                      d63Upper middle class 
                                                 1.06363179 
                                            d63Higher class 
                                                 1.61835200 
                                      sd3Orthodox Christian 
                                                 0.78993855 
                                              sd3Prostetant 
                                                 1.12131323 
                                         sd3Other Christian 
                                                 1.03005237 
                                                  sd3Jewish 
                                                 1.41325666 
                                           sd3Muslim - Shia 
                                                 0.74664820 
                                          sd3Muslin - Sunni 
                                                 0.29094103 
                                            sd3Other Muslim 
                                                 0.72973408 
                                                    sd3Sikh 
                                                 0.55335100 
                                                sd3Buddhist 
                                                 1.03442931 
                                                   sd3Hindu 
                                                 1.86774831 
                                                 sd3Atheist 
                                                 1.32121108 
                                                sd3Agnostic 
                                                 1.21607416 
                                                    sd1_7No 
                                                 0.74380459 
                                                         d8 
                                                 1.01034592 
                                                      qc1_4 
                                                 0.92812155 
                                                      qc1_8 
                                                 1.04893499 
                                                     qc6_1r 
                                                 1.30315039 
                                                     qc6_2r 
                                                 1.06168518 
                                                     qc6_3r 
                                                 0.96346103 
                                                    qc6_10r 
                                                 1.10798198 
                                                        qc7 
                                                 0.98381254 
                                                      qc9_1 
                                                 0.98662707 
                                                      qc5_1 
                                                 0.74842628 
                                                      qc5_3 
                                                 1.18269203 
                                                   qc12_10r 
                                                 1.10559674 
                                                     qc15_1 
                                                 0.76208491 
                                                     qc15_2 
                                                 0.88923331 
                                                     qc15_3 
                                                 0.82214272 
                                                     qc17_2 
                                                 0.86256714 
                                                     qc17_5 
                                                 0.81166489 
                                                     qc20No 
                                                 0.06948703 
                                                         d1 
                                                 0.98117368 
                                                        d11 
                                                 1.00388001 
                                                 qc2_recode 
                                                 0.84083408 
                                                  Marriage1 
                                                 1.11015967 
                                         `Hate Crime Laws`1 
                                                 0.81528257 
`Existence of gender recogition administrative procedures`1 
                                                 0.77134291 
                              `No medical diag0sis needed`1 
                                                 1.80989488 
                                         Depathologisation1 
                                                 2.30500067 
                                                  OBS_VALUE 
                                                 1.02339524 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc, <span class="at">col=</span><span class="st">'green'</span>, <span class="at">print.thres=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="project_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>roc<span class="sc">$</span>levels</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "No"  "Yes"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(predictions, testing.data<span class="sc">$</span>qc19)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   No  Yes
       No  2248  832
       Yes  392 2791
                                          
               Accuracy : 0.8046          
                 95% CI : (0.7945, 0.8143)
    No Information Rate : 0.5785          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.6081          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.8515          
            Specificity : 0.7704          
         Pos Pred Value : 0.7299          
         Neg Pred Value : 0.8768          
             Prevalence : 0.4215          
         Detection Rate : 0.3589          
   Detection Prevalence : 0.4918          
      Balanced Accuracy : 0.8109          
                                          
       'Positive' Class : No              
                                          </code></pre>
</div>
</div>
<ul>
<li><p>d70 - Life Satisfaction: From the summary, the relevance of the “not very” and “not at all” satisfaction levels is clearly evident. Specifically, those who reported being “not very” satisfied with their life show a 28% lower likelihood of supporting transgender individuals changing their documents compared to those who are very satisfied. This disparity further increases for those who are “not at all” satisfied with their life, with a 38% discrepancy compared to those who are completely satisfied. This result supports the hypothesis that individuals who are less satisfied with their life may exhibit greater hostility towards their surroundings, potentially influencing their inclination to support rights for individuals perceived as different from themselves.</p></li>
<li><p>d63 - Social Class: Speaking about social stratification, we observe that only the highest level of social class appears to be significant. Specifically, it seems that the uppermost segment of the social scale is 2.24 times more supportive of transgender individuals changing their documents compared to the working class. These findings are not surprising, as higher social classes are often associated with higher levels of education and culture, which may make them more open and inclined to support civil rights.</p></li>
<li><p>sd3 - Religion: Now let’s consider religion. In this case, we see very different results. Indeed, we notice that being Protestant, atheist, or agnostic entails greater consensus in favor of the possibility for transgender individuals to change their identity on documents. Conversely, those who adhere to religions considered more conservative, such as Orthodox Christians and particularly Sunni Muslims, are less supportive of endorsing this type of right.</p></li>
<li><p>sd1_7 - Having friends or acquaintances who are transgender: Similarly, these results appear quite logical. Individuals who do not have any transgender friends or acquaintances are approximately 25% less likely to support the change of identity on transgender individuals’ documents. Indeed, lacking direct, firsthand contact with transgender individuals may lead to underestimating the importance of this need and not perceiving it as an urgent issue.</p></li>
<li><p>d8 - Education: In this case as well, much like we observed for social class, higher education appears to be positively associated with greater support. In fact, each additional year spent in full-time education increases the likelihood of supporting the right in question by 1%.</p></li>
<li><p>qc1 - Discrimination: Regarding the perception of discrimination in one’s own country, the results seem to be somewhat conflicting and, consequently, surprising. In fact, it appears that regarding discrimination related to sexual orientation, the more rare such discrimination is perceived to be, the less support there is for this right for transgender individuals. However, when it comes to discrimination against transgender people, the more this discrimination is perceived as rare, the greater the support for this right.</p></li>
<li><p>qc6 - Having a person from certain groups in the highest elected political position: In this case, the results become entirely logical. Indeed, we notice that the more comfortable one feels with having gay, lesbian, or bisexual individuals in top political positions, the greater the support for the right to change identity on transgender individuals’ documents (increasing by approximately 28%). The same applies to groups of individuals belonging to minority ethnicities (in this case, the percentage is about 9%). As for having transgender individuals in top political roles, although with a not too high p-value, we can state that feeling more comfortable with these individuals in leadership positions leads to an increased support of about 6% for the aforementioned right.</p></li>
<li><p>qc5_1. Shared content online about discrimination incidents. People who have done this in the last 12 months seem to have a lower chance of supporting the target question. This might be related to supporting some other kinds of discrimination that aren’t LGBT related.</p></li>
<li><p>qc5_3 - Joined an association or campaign agains discrimination. People who have joined an association in the last 12 months are 12% more likely to answer positively to the target question.</p></li>
<li><p>qc12_10r - How comfortable would you be with a gay, lesbian or bisexual coworker. When people answer they would be more comfortable, on a scale from 1 to 3, each 1 unit increase means a 8% increase in the chance of supporting trans people documentation change. This is the only variant of the question that was significant for the model.</p></li>
</ul>
<p>Now about three statements regarding LGBT equality:</p>
<ul>
<li><p>qc15_1 - Gay, lesbian and bisexual people should have the same rights as heterosexual people. When people answer higher values in the scale (disagree, totally disagree, 1 unit increase in the variable) the probability of answering positively to the target question lowers by -27%.</p></li>
<li><p>qc15_2 - There’s nothing wrong in same-sex relationships. As people answer more in disagree, the chance of supporting the target variable decreases.</p></li>
<li><p>qc15_3 - Same sex marriage should be allowed in Europe. This question is a scale. Each 1 unit increase in the scale (from totally agree to agree, to disagree and totally disagree) is a 10% increase on people answering negatively to the target question. However this one is the statement with less impact in the model.</p></li>
<li><p>qc17_2 - School should educate about ethnic origin or skin colour. The answers are in a scale (1: totally agree, 4: totally disagree). As people disagree more, there’s a 14% decrease in the chance of them supporting trans people documentation change.</p></li>
<li><p>qc17_5 - School should educate about being intersex. When people disagree more with this statement, the probability of supporting the target question decreases.</p></li>
<li><p>qc20 - Believe that documents should have a third option for gender. When people answers no to that question, it’s a 83% chance decrease in people being supportive of trans people changing their documents.</p></li>
<li><p>d1 - Ideology. As people identify more to the right, the support decreases. 1 unit increase in the ideology scale is a 3% decrease in support for trans people changing their documentation.</p></li>
<li><p>d11- Age. As age increases, there’s a slight increase in supportiveness. However in the descriptive analysis we saw how the oldest people were the less supportive. This might be due to people being more supportive in middle age but then decreasing in older ages.</p></li>
<li><p>qc2_recode - Experienced discrimination. People who have experienced discrimination is 13% less likely to be supportive. This might be due to discrimination linked to certain social groups who are less likely to be supportive. Discrimination for experiencing LGBTphobia specifically wasn’t significant for the model.</p></li>
<li><p>Legalised homosexual Marriage. Population from countries where there’s legal homosexual marriage is slightly more likely to support trans people documentation change.</p></li>
<li><p>Hate Crime Laws. In countries where there are hate crime laws, it’s a bit less likely for the population to be supportive.</p></li>
<li><p>Existence of gender recognition procedures. People who live in countries with these kind of laws are 27% less likely to support trans people.</p></li>
</ul>
<p>These results might be becase many countries have these laws and it doesn’t seem to be linked to the support of the population.</p>
<p>However, in countries with more progressive laws with have a focus and recognition of the problems trans people face, population seems to be more supportive:</p>
<ul>
<li><p>No medical diagnosis needed. People who live in countries where trans people don’t need medical diagnosis to follow certain procedures are 1.8 times more likely to be supportive.</p></li>
<li><p>Depathologisation laws. People who live in countries with specific dephatologisation laws towards transgender identities are 2.26 times more likely to answer positively to our target question than those who don’t. However only 2 countries have these kind of laws in 2019.</p></li>
</ul>
<p>And lastly, for the GINI index:</p>
<ul>
<li>OBS_VALUE - GINI index value. People who live in countries with a higher GINI index value are sllightly more likely to be supportive. Per each 1 unit increase in the index value, someone is 1% more likely to support trans people changing their documentation.</li>
</ul>
</section>
<section id="random-forest" class="level2">
<h2 class="anchored" data-anchor-id="random-forest">Random forest</h2>
<p>The random forest model below shows a fair predictive accuracy but not much better than random chance. The accuracy when compared with the testing data was only 67%. Due to it’s low accuracy rate and the difficulty in interpretation, we have decided that the best model for prediction is the logistic model.</p>
<p>According to this random forest model, the most important variable is whether someone believes that there should be a third option on passports and birth certificates besides Male and Female. Second most important was whether someone agrees with the statement: “Same sex marriges should be allowed in Europe.” Age also appears to be important.</p>
<p>In contrast to the logistic model, some variables are not considered important. Knowing someone who is transgender is not considered important for random forest. Neither are religion and life satisfaction.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>ctrl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"repeatedcv"</span>, </span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">number =</span> <span class="dv">5</span>,</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">classProbs =</span> T,</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">summaryFunction=</span>twoClassSummary,</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">verboseIter =</span> T)</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>rfFit <span class="ot">&lt;-</span> <span class="fu">train</span>(qc19 <span class="sc">~</span> d70 <span class="sc">+</span> qa1 <span class="sc">+</span> d63 <span class="sc">+</span> sd3 <span class="sc">+</span> sd1_7 <span class="sc">+</span> d8 <span class="sc">+</span> qc1_4 <span class="sc">+</span> qc1_8 <span class="sc">+</span> qc6_1r <span class="sc">+</span> qc6_2r <span class="sc">+</span> qc6_3r <span class="sc">+</span> qc6_10r <span class="sc">+</span> qc7 <span class="sc">+</span> qc9_1 <span class="sc">+</span> qc5_1 <span class="sc">+</span> qc12_10r <span class="sc">+</span> qc15_1 <span class="sc">+</span> qc15_2 <span class="sc">+</span> qc15_3 <span class="sc">+</span> qc17_2  <span class="sc">+</span> qc17_5 <span class="sc">+</span> qc20 <span class="sc">+</span> d1 <span class="sc">+</span> d11 <span class="sc">+</span> d10 <span class="sc">+</span> qc2_recode <span class="sc">+</span>  <span class="st">`</span><span class="at">Hate Crime Laws</span><span class="st">`</span> <span class="sc">+</span>  <span class="st">`</span><span class="at">Existence of gender recogition administrative procedures</span><span class="st">`</span><span class="sc">+</span> <span class="st">`</span><span class="at">No medical diag0sis needed</span><span class="st">`</span> <span class="sc">+</span>  <span class="st">`</span><span class="at">Depathologisation</span><span class="st">`</span> <span class="sc">+</span> OBS_VALUE, </span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> training.data,</span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"rf"</span>,   </span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">preProc=</span><span class="fu">c</span>(<span class="st">'scale'</span>,<span class="st">'center'</span>),</span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">tuneLength =</span> <span class="dv">5</span>,</span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">metric=</span><span class="st">"ROC"</span>,</span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">trControl =</span> ctrl, </span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">na.action =</span> na.omit )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>+ Fold1.Rep1: mtry= 2 
- Fold1.Rep1: mtry= 2 
+ Fold1.Rep1: mtry=13 
- Fold1.Rep1: mtry=13 
+ Fold1.Rep1: mtry=25 
- Fold1.Rep1: mtry=25 
+ Fold1.Rep1: mtry=37 
- Fold1.Rep1: mtry=37 
+ Fold1.Rep1: mtry=49 
- Fold1.Rep1: mtry=49 
+ Fold2.Rep1: mtry= 2 
- Fold2.Rep1: mtry= 2 
+ Fold2.Rep1: mtry=13 
- Fold2.Rep1: mtry=13 
+ Fold2.Rep1: mtry=25 
- Fold2.Rep1: mtry=25 
+ Fold2.Rep1: mtry=37 
- Fold2.Rep1: mtry=37 
+ Fold2.Rep1: mtry=49 
- Fold2.Rep1: mtry=49 
+ Fold3.Rep1: mtry= 2 
- Fold3.Rep1: mtry= 2 
+ Fold3.Rep1: mtry=13 
- Fold3.Rep1: mtry=13 
+ Fold3.Rep1: mtry=25 
- Fold3.Rep1: mtry=25 
+ Fold3.Rep1: mtry=37 
- Fold3.Rep1: mtry=37 
+ Fold3.Rep1: mtry=49 
- Fold3.Rep1: mtry=49 
+ Fold4.Rep1: mtry= 2 
- Fold4.Rep1: mtry= 2 
+ Fold4.Rep1: mtry=13 
- Fold4.Rep1: mtry=13 
+ Fold4.Rep1: mtry=25 
- Fold4.Rep1: mtry=25 
+ Fold4.Rep1: mtry=37 
- Fold4.Rep1: mtry=37 
+ Fold4.Rep1: mtry=49 
- Fold4.Rep1: mtry=49 
+ Fold5.Rep1: mtry= 2 
- Fold5.Rep1: mtry= 2 
+ Fold5.Rep1: mtry=13 
- Fold5.Rep1: mtry=13 
+ Fold5.Rep1: mtry=25 
- Fold5.Rep1: mtry=25 
+ Fold5.Rep1: mtry=37 
- Fold5.Rep1: mtry=37 
+ Fold5.Rep1: mtry=49 
- Fold5.Rep1: mtry=49 
Aggregating results
Selecting tuning parameters
Fitting mtry = 13 on full training set</code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>rfProb <span class="ot">=</span> <span class="fu">predict</span>(rfFit, testing.data, <span class="at">type=</span><span class="st">"prob"</span>)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>prediction <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">ifelse</span>(rfProb<span class="sc">$</span>Yes <span class="sc">&gt;</span> <span class="fl">0.4</span>, <span class="st">"Yes"</span>, <span class="st">"No"</span>))</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>testing.data1 <span class="ot">&lt;-</span> testing.data[<span class="fu">row_number</span>(rfProb),]</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(testing.data1<span class="sc">$</span>qc19, prediction) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   No  Yes
       No  1282 1058
       Yes  999 2938
                                          
               Accuracy : 0.6723          
                 95% CI : (0.6605, 0.6839)
    No Information Rate : 0.6366          
    P-Value [Acc &gt; NIR] : 1.726e-09       
                                          
                  Kappa : 0.2956          
                                          
 Mcnemar's Test P-Value : 0.201           
                                          
            Sensitivity : 0.5620          
            Specificity : 0.7352          
         Pos Pred Value : 0.5479          
         Neg Pred Value : 0.7463          
             Prevalence : 0.3634          
         Detection Rate : 0.2042          
   Detection Prevalence : 0.3728          
      Balanced Accuracy : 0.6486          
                                          
       'Positive' Class : No              
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>rf_imp <span class="ot">&lt;-</span> <span class="fu">varImp</span>(rfFit, <span class="at">scale =</span> T)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rf_imp, <span class="at">scales =</span> <span class="fu">list</span>(<span class="at">y =</span> <span class="fu">list</span>(<span class="at">cex =</span> .<span class="dv">95</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="project_files/figure-html/rf-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pdp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'pdp'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    partial</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">partial</span>(rfFit, <span class="at">pred.var =</span> <span class="st">"qc15_3"</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>, <span class="at">rug =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="project_files/figure-html/rf-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">partial</span>(rfFit, <span class="at">pred.var =</span> <span class="st">"qc20"</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>, <span class="at">rug =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="project_files/figure-html/rf-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>